<!DOCTYPE html><html class="appearance-auto" lang="en"><head><meta charset="UTF-8"><title>Python Coding Style</title><meta name="description" content="Austin Chang's blog"><meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no, initial-scale=1"><!-- Google Tag Manager --><script>(function(w,d,s,l,i){
  w[l]=w[l]||[];
  w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});
  var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),
    dl=l!='dataLayer'?'&l='+l:'';
  j.async=true;
  j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;
  f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-WXVFCZNQ');</script><!-- End Google Tag Manager -->
<!-- Google Analytics --><!-- End Google Analytics -->
<!-- Baidu Analytics --><!-- End Baidu Analytics --><link rel="icon" href="/images/fav.ico"><link rel="stylesheet" href="/style/common/bulma.css"><link rel="stylesheet" href="/style/base.css"><link rel="stylesheet" href="/style/common/helper.css"><script src="/js/common.js"></script><link rel="stylesheet" href="/style/post.css"><link rel="stylesheet" href="/style/themes/highlight-theme-light.css"><link rel="stylesheet" href="/style/common/jquery.fancybox.min.css"><script src="/js/highlight.pack.js"></script><meta name="description" content="Follow Google Python Style Guide，下方列出幾點我覺得重要的。
Naming
使用 Snake Case 命名
Internal 表示僅 module 內可用，或是 private
下劃線 (_) 開頭表示 module variable，或函數是 protected的 (使用import * from時不會包含)
雙下劃線 (__) 開頭的 instance variable 或 method 表示類內私有.


CommentsFunctions and Methods
Args
Returns
Raises

def fetch_smalltable_rows(
    table_handle: smalltable.Table,
    keys: Sequence[.."><meta name="generator" content="Hexo 7.1.1"></head><body class="is-flex is-flex-direction-column"><!-- Google Tag Manager (noscript) --><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WXVFCZNQ"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><!-- End Google Tag Manager (noscript) --><header class="header-widget is-flex-shrink-0 is-hidden-mobile"><div class="container is-fullhd is-flex is-justify-content-space-between is-align-items-center is-full-height"><section class="is-hidden-mobile is-flex-shrink-0"><h2><a href="/">Austin Chang's blog</a></h2></section><h3 class="is-hidden-mobile is-family-serif is-full-height is-flex is-align-items-center is-flex-shrink-0"><div class="is-full-height" id="postTopic"><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">Python Coding Style</p><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">Click back to the top</p></div></h3><aside class="is-flex-shrink-0"><h3 class="is-inline-block"><a href="/">Home</a></h3><h3 class="is-inline-block"><a href="/about">About</a></h3><h3 class="is-inline-block"><a href="/archives">Archives</a></h3></aside></div></header><header class="is-flex header-widget is-flex-shrink-0 is-align-items-center is-justify-content-center is-hidden-tablet"><h3 class="is-inline-block"><a href="/">Home</a></h3><h3 class="is-inline-block"><a href="/about">About</a></h3><h3 class="is-inline-block"><a href="/archives">Archives</a></h3></header><main><main class="container is-max-widescreen content section post-page pt-4 px-4"><div class="columns is-flex-desktop is-justify-content-center is-flex-direction-row-reverse"><div class="column is-3 is-hidden-mobile"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Naming"><span class="toc-text">Naming</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Comments"><span class="toc-text">Comments</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Functions-and-Methods"><span class="toc-text">Functions and Methods</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Classes"><span class="toc-text">Classes</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Block-and-Inline-Comments"><span class="toc-text">Block and Inline Comments</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Imports-formatting"><span class="toc-text">Imports formatting</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Tools"><span class="toc-text">Tools</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#isort"><span class="toc-text">isort</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#flake8"><span class="toc-text">flake8</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#yapf"><span class="toc-text">yapf</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#setting-json"><span class="toc-text">setting.json</span></a></li></ol></li></ol></div><div class="column is-9"><header class="my-4"><a href="/tags/%E8%BB%9F%E9%AB%94"><i class="tag post-item-tag">軟體</i></a></header><h1 class="mt-0 mb-1 is-family-serif" id="postTitle">Python Coding Style</h1><time class="has-text-grey" datetime="2024-01-20T16:00:00.000Z">2024-01-21</time><article class="mt-2 post-content"><p>Follow <a target="_blank" rel="noopener external nofollow noreferrer" href="https://google.github.io/styleguide/pyguide.html">Google Python Style Guide</a>，下方列出幾點我覺得重要的。</p>
<h2 id="Naming"><a href="#Naming" class="headerlink" title="Naming"></a>Naming</h2><ol>
<li>使用 Snake Case 命名</li>
<li>Internal 表示僅 module 內可用，或是 private</li>
<li>下劃線 (_) 開頭表示 module variable，或函數是 protected的 (使用import * from時不會包含)</li>
<li>雙下劃線 (__) 開頭的 instance variable 或 method 表示類內私有.</li>
</ol>
<p><img src="/Python-Coding-Style/naming.png"></p>
<h2 id="Comments"><a href="#Comments" class="headerlink" title="Comments"></a>Comments</h2><h3 id="Functions-and-Methods"><a href="#Functions-and-Methods" class="headerlink" title="Functions and Methods"></a>Functions and Methods</h3><ol>
<li>Args</li>
<li>Returns</li>
<li>Raises</li>
</ol>
<pre><code class="python">def fetch_smalltable_rows(
    table_handle: smalltable.Table,
    keys: Sequence[bytes | str],
    require_all_keys: bool = False,【
) -&gt; Mapping[bytes, tuple[str, ...]]:
    &quot;&quot;&quot;Fetches rows from a Smalltable.

    Retrieves rows pertaining to the given keys from the Table instance
    represented by table_handle.  String keys will be UTF-8 encoded.

    Args:
        table_handle: An open smalltable.Table instance.
        keys: A sequence of strings representing the key of each table
          row to fetch.  String keys will be UTF-8 encoded.
        require_all_keys: If True only rows with values set for all keys will be
          returned.

    Returns:
        A dict mapping keys to the corresponding table row data
        fetched. Each row is represented as a tuple of strings. For
        example:

        &#123;b&#39;Serak&#39;: (&#39;Rigel VII&#39;, &#39;Preparer&#39;),
         b&#39;Zim&#39;: (&#39;Irk&#39;, &#39;Invader&#39;),
         b&#39;Lrrr&#39;: (&#39;Omicron Persei 8&#39;, &#39;Emperor&#39;)&#125;

        Returned keys are always bytes.  If a key from the keys argument is
        missing from the dictionary, then that row was not found in the
        table (and require_all_keys must have been False).

    Raises:
        IOError: An error occurred accessing the smalltable.
    &quot;&quot;&quot;
</code></pre>
<h3 id="Classes"><a href="#Classes" class="headerlink" title="Classes"></a>Classes</h3><pre><code class="python">class SampleClass:
    &quot;&quot;&quot;Summary of class here.

    Longer class information...
    Longer class information...

    Attributes:
        likes_spam: A boolean indicating if we like SPAM or not.
        eggs: An integer count of the eggs we have laid.
    &quot;&quot;&quot;

    def __init__(self, likes_spam: bool = False):
        &quot;&quot;&quot;Initializes the instance based on spam preference.

        Args:
          likes_spam: Defines if instance exhibits this preference.
        &quot;&quot;&quot;
        self.likes_spam = likes_spam
        self.eggs = 0

    def public_method(self):
        &quot;&quot;&quot;Performs operation blah.&quot;&quot;&quot;
</code></pre>
<h3 id="Block-and-Inline-Comments"><a href="#Block-and-Inline-Comments" class="headerlink" title="Block and Inline Comments"></a>Block and Inline Comments</h3><pre><code class="python"># We use a weighted dictionary search to find out where i is in
# the array.  We extrapolate position based on the largest num
# in the array and the array size and then do binary search to
# get the exact number.

if i &amp; (i-1) == 0:  # True if i is 0 or a power of 2.
</code></pre>
<h3 id="Imports-formatting"><a href="#Imports-formatting" class="headerlink" title="Imports formatting"></a>Imports formatting</h3><pre><code class="python">Yes: from collections.abc import Mapping, Sequence
     import os
     import sys
     from typing import Any, NewType


No:  import os, sys
</code></pre>
<p>導入需要放在文件頂部，導入按照下方順序。各分組中，需要根據字母大小排序，忽略大小寫</p>
<ol>
<li>標準庫導入</li>
<li>第三方庫導入</li>
<li>應用程序指定導入</li>
</ol>
<pre><code class="python">import collections
import queue
import sys
from absl import app
from absl import flags
import bs4
import cryptography
import tensorflow as tf
from book.genres import scifi
from myproject.backend import huxley
from myproject.backend.hgwells import time_machine
from myproject.backend.state_machine import main_loop
from otherproject.ai import body
from otherproject.ai import mind
from otherproject.ai import soul
# Older style code may have these imports down here instead:
#from myproject.backend.hgwells import time_machine
#from myproject.backend.state_machine import main_loop
</code></pre>
<h2 id="Tools"><a href="#Tools" class="headerlink" title="Tools"></a>Tools</h2><h3 id="isort"><a href="#isort" class="headerlink" title="isort"></a>isort</h3><p>自動排序 import 程式行令其符合 PEP8 風格。</p>
<pre><code class="json">&quot;isort.args&quot;: [
    &quot;--src=$&#123;workspaceFolder&#125;&quot;,
    &quot;--line-length=120&quot;,
],
</code></pre>
<p>存檔時自動格式化</p>
<pre><code class="json">&quot;[python]&quot;: &#123;
    &quot;editor.codeActionsOnSave&quot;: &#123;
        &quot;source.organizeImports&quot;: true
    &#125;,
    ...
&#125;,
</code></pre>
<h3 id="flake8"><a href="#flake8" class="headerlink" title="flake8"></a>flake8</h3><p>為 Python Linter，檢查程式是否有語法錯誤並提示、檢查程式是否符合 PEP 8 風格並提示。VS Code 設定 Flake8 只有幾個重要的環節，依序如下:</p>
<p>開啟 Python Linting：Python › Linting: Enabled<br>開啟 Flake8 Linting：Python › Linting: Flake8 Enabled<br>設定 Flake8 Args（非必要）：Python › Linting: Flake8 Args</p>
<p>或是直接在 VS Code 的settings.json 加入以下內容</p>
<pre><code class="json">&quot;python.linting.enabled&quot;: true, // 預設值即為 true
&quot;python.linting.flake8Enabled&quot;: true,
&quot;python.linting.flake8Args&quot;: [
  &quot;--max-line-length=120&quot;,
  &quot;--ignore=E402,F841,F401,E302,E305&quot;,
]
</code></pre>
<h3 id="yapf"><a href="#yapf" class="headerlink" title="yapf"></a>yapf</h3><p>Python formatter，主要是為了讓 Python 程式碼可以最大限度遵守 PEP 8 及一般風格規範。settings.json設定如下：</p>
<pre><code class="json">&quot;python.formatting.provider&quot;: &quot;yapf&quot;,
&quot;python.formatting.yapfArgs&quot;: [
    &quot;--style=&#123;column_limit=120&#125;&quot;
  ],
&quot;editor.formatOnSave&quot;: true, // 不支援 afterDelay 自動存檔
</code></pre>
<h3 id="setting-json"><a href="#setting-json" class="headerlink" title="setting.json"></a>setting.json</h3><p>這是我的 vscode 設定</p>
<pre><code class="json">&quot;[python]&quot;: &#123;
        &quot;editor.codeActionsOnSave&quot;: &#123;
            &quot;source.organizeImports&quot;: true
        &#125;,
        &quot;editor.formatOnSave&quot;: true,
        &quot;editor.defaultFormatter&quot;: &quot;eeyore.yapf&quot;,
    &#125;,
    &quot;yapf.args&quot;: [
        &quot;--style&quot;, &quot;&#123;based_on_style: yapf, column_limit=120,INDENT_WIDTH=4,SPLIT_BEFORE_DOT=false,SPLIT_ALL_TOP_LEVEL_COMMA_SEPARATED_VALUES=true,spaces_before_comment=&#39;15, 20&#39;&#125;&quot;
    ],

    &quot;isort.args&quot;: [
        &quot;--src=$&#123;workspaceFolder&#125;&quot;,
        &quot;--line-length=120&quot;,
    ],
    &quot;flake8.args&quot;:[
        &quot;--max-line-length=120&quot;,
        &quot;--ignore=E402,F841,F401,E302,E305,W503,W292,E501,F841&quot;,
    ],
</code></pre>
</article><section class="jump-container is-flex is-justify-content-space-between my-6"><!-- em is empty placeholder--><em></em><a class="button is-default" href="/Code-Review-Guide-%E2%80%94-%E5%A6%82%E4%BD%95Code-Review/" title="Code Review Guide — 如何Code Review?"><span class="has-text-weight-semibold">Next: Code Review Guide — 如何Code Review?</span><i class="iconfont icon-next ml-2 has-text-grey"></i></a></section><article class="mt-6 comment-container"><script async repo="chung5116/Austin-Chang" src="https://utteranc.es/client.js" issue-term="pathname" theme="preferred-color-scheme"></script></article></div></div></main></main><footer class="is-flex is-flex-direction-column is-align-items-center is-flex-shrink-0 is-family-serif"><section class="sns-container"><!-- Github--><a title="github" target="_blank" rel="noopener nofollow" href="//github.com/chung5116"><i class="iconfont icon-github"></i></a><!-- Ins--><!-- RSS--><!-- 知乎--><!-- 领英--><a title="linkedin" target="_blank" rel="noopener nofollow" href="//www.linkedin.com/in/austin-chang-73446a19a"><i class="iconfont icon-linkedin"></i></a><!-- 脸书--></section><p><span>Copyright ©</span><span> Austin Chang 2024</span></p><div class="is-flex is-justify-content-center is-flex-wrap-wrap"><p>Powered by Hexo &verbar;&nbsp;</p><p class="is-flex is-justify-content-center"><a title="Hexo theme author" target="_blank" rel="noopener" href="//github.com/haojen">Theme by Haojen&nbsp;</a></p><div style="margin-top: 2px"><a class="github-button" title="github-button" target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/haojen/hexo-theme-Claudia" data-color-scheme="no-preference: light; light: light; dark: dark;" data-show-count="true"></a></div></div><div><span></span></div></footer><script async defer src="https://buttons.github.io/buttons.js"></script><script src="/js/jquery-3.6.1.min.js"></script><script src="/js/jquery-fancybox.min.js"></script><script src="/js/img_zoom.js"></script><script src="/js/post.js"></script></body></html>